<% include ../partials/header %>
<% include ../partials/navbar %> 
<div class="main">
  <!-- Animating header and tag-line -->
  <div class="index-header">
    <h1 class="anime-text">
      <span class="text-wrapper">
        <span class="letters">Welcome to Hidden Wonderz</span>
      </span>
    </h1>
    <h2 class="tag-line">Some attractive tag-line</h2>  
  </div> 
  <div class="ui container">
    <div class="ui grid">
      <div class="ten wide column">
        <form class="ui form" action="/places" method="GET">
          <div class="ui search">
            <div class="ui icon input">
              <input style="width: 300px; border-radius: 1.2rem;" name="search" type="text" placeholder="Search via name or location...">
              <i class="search icon"></i>
            </div>
          </div>
        </form>
      </div>
      <div class="right aligned six wide column">
        <a class="ui labeled icon button" href="/places/new">
          <i class="plus icon"></i>
            <span class="add-button">Add new place</span>
        </a>
      </div>
    </div>
    <div class="ui horizontal divider">BLOG POSTS</div>
    <% if(noMatch !== undefined) { %>
      <h3><%= noMatch %></h3>
    <% } %>
    <div class="grid-structure">
      <div class="masonry">
        <% places.forEach(function(place){ %>
          <div id="masonry-item" class="item">
            <div class="ui cards">
              <div class="card">
                <div class="image">
                  <img src="<%= place.images[0] %>">
                </div>
                <div class="content">
                  <div class="header">
                    <%= place.name %> <br>
                    (<%= place.location %>)
                  </div>
                  <div class="description">
                    <a href="/places/<%= place._id %>" class="ui button full-width" data-tooltip="Click here for more info on <%= place.name %>" data-position="top left" data-inverted="">More Info</a>
                  </div>
                </div>
                <div class="extra content">
                  <i class="user icon"></i>Created by: <%= place.author.username %>
                </div>
              </div>
            </div>
          </div>
        <% }); %>
      </div>
    </div>
    <!-- Pagination -->
    <div class="ui center aligned grid">
      <div class="sixteen wide column">
        <% if (pages && pages > 0) { %>
        <div class="ui pagination menu">
          <% if (current == 1) { %>
            <div class="disabled item">First</div>
          <% } else { %>
            <a class="item" href="/places">First</a>
          <% } %>

          <% if (current == 1) { %>
            <div class="disabled item">«</div>
          <% } else { %>
            <a class="item" href="/places?page=<%= Number(current) - 1 %>">«</a>
          <% } %>
          <% var i = (Number(current) > 5 ? Number(current) - 4 : 1) %>
          <% if (i !== 1) { %>
            <div class="disabled item">...</div>
          <% } %>
          <% for (; i <= (Number(current) + 4) && i <= pages; i++) { %>
            <% if (i == current) { %>
              <a class="active item"><%= i %></a>
            <% } else { %>
              <a class="item" href="/places?page=<%= i %>"><%= i %></a>
            <% } %>
            <% if (i == Number(current) + 4 && i < pages) { %>
              <div class="disabled item">...</div>
            <% } %>
          <% } %>
          <% if (current == pages) { %>
            <div class="disabled item">»</div>
          <% } else { %>
            <a class="item" href="/places?page=<%= Number(current) + 1 %>">»</a>
          <% } %>
          <% if (current == pages) { %>
            <div class="disabled item">Last</div>
          <% } else { %>
            <a class="item" href="/places?page=<%= pages %>">Last</a>
          <% } %>
        </div>
        <% } %>
      </div>
    </div>
  </div>
</div>

<% include ../partials/footer %>
